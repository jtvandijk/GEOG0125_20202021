<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Spatial-Temporal Mobility Analysis | GEOG0125: Advanced Topics in Social and Geographic Data Science</title>
  <meta name="description" content="7 Spatial-Temporal Mobility Analysis | GEOG0125: Advanced Topics in Social and Geographic Data Science." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Spatial-Temporal Mobility Analysis | GEOG0125: Advanced Topics in Social and Geographic Data Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jtvandijk.github.io/GEOG0125/" />
  
  <meta property="og:description" content="7 Spatial-Temporal Mobility Analysis | GEOG0125: Advanced Topics in Social and Geographic Data Science." />
  <meta name="github-repo" content="jtvandijk/GEOG0125" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Spatial-Temporal Mobility Analysis | GEOG0125: Advanced Topics in Social and Geographic Data Science" />
  
  <meta name="twitter:description" content="7 Spatial-Temporal Mobility Analysis | GEOG0125: Advanced Topics in Social and Geographic Data Science." />
  

<meta name="author" content="Justin van Dijk and Stephen Law" />


<meta name="date" content="2021-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-data-science-applications.html"/>
<link rel="next" href="unix-tools.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.4/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo">
<a href="https://www.ucl.ac.uk/module-catalogue/modules/advanced-topics-in-social-data-science-GEOG0125"><img src="images/general/ucl_logo.png">
</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#weekly-topics"><i class="fa fa-check"></i>Weekly topics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#moodle"><i class="fa fa-check"></i>Moodle</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#useful-additional-resources"><i class="fa fa-check"></i>Useful additional resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#office-hours"><i class="fa fa-check"></i>Office hours</a></li>
</ul></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="part"><span><b>Inference</b></span></li>
<li class="chapter" data-level="2" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html"><i class="fa fa-check"></i><b>2</b> Statistical Inference and Causality</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#intro-w09"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#reading-list-w01"><i class="fa fa-check"></i><b>2.1.1</b> Reading list</a></li>
<li class="chapter" data-level="2.1.2" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#technical-help-session"><i class="fa fa-check"></i><b>2.1.2</b> Technical Help session</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#statistical-inference"><i class="fa fa-check"></i><b>2.2</b> Statistical inference</a></li>
<li class="chapter" data-level="2.3" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#causality"><i class="fa fa-check"></i><b>2.3</b> Causality</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#what-is-causality"><i class="fa fa-check"></i><b>2.3.1</b> What is causality?</a></li>
<li class="chapter" data-level="2.3.2" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#the-problem-with-causality"><i class="fa fa-check"></i><b>2.3.2</b> The problem with causality</a></li>
<li class="chapter" data-level="2.3.3" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#fixed-effects-models"><i class="fa fa-check"></i><b>2.3.3</b> Fixed effects models</a></li>
<li class="chapter" data-level="2.3.4" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#random-effects-models"><i class="fa fa-check"></i><b>2.3.4</b> Random effects models</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#thm-w02"><i class="fa fa-check"></i><b>2.4</b> Take home message</a></li>
<li class="chapter" data-level="2.5" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#attributions_w02"><i class="fa fa-check"></i><b>2.5</b> Attributions</a></li>
</ul></li>
<li class="part"><span><b>GeoAI</b></span></li>
<li class="chapter" data-level="3" data-path="introduction-to-deep-learning.html"><a href="introduction-to-deep-learning.html"><i class="fa fa-check"></i><b>3</b> Introduction to Deep Learning</a></li>
<li class="chapter" data-level="4" data-path="keynote-spatial-data-science.html"><a href="keynote-spatial-data-science.html"><i class="fa fa-check"></i><b>4</b> Keynote: Spatial Data Science</a></li>
<li class="chapter" data-level="5" data-path="convolutional-neural-networks.html"><a href="convolutional-neural-networks.html"><i class="fa fa-check"></i><b>5</b> Convolutional Neural Networks</a></li>
<li class="chapter" data-level="6" data-path="spatial-data-science-applications.html"><a href="spatial-data-science-applications.html"><i class="fa fa-check"></i><b>6</b> Spatial Data Science Applications</a></li>
<li class="chapter" data-level="7" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html"><i class="fa fa-check"></i><b>7</b> Spatial-Temporal Mobility Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#intro-w07"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#reading-list-w07"><i class="fa fa-check"></i><b>7.1.1</b> Reading list</a></li>
<li class="chapter" data-level="7.1.2" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#technical-help-session"><i class="fa fa-check"></i><b>7.1.2</b> Technical Help session</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#gps-data"><i class="fa fa-check"></i><b>7.2</b> GPS data</a></li>
<li class="chapter" data-level="7.3" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#gps-data-classification"><i class="fa fa-check"></i><b>7.3</b> GPS data classification</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#gps-data-preparation"><i class="fa fa-check"></i><b>7.3.1</b> GPS data preparation</a></li>
<li class="chapter" data-level="7.3.2" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#gps-data-classification-1"><i class="fa fa-check"></i><b>7.3.2</b> GPS data classification</a></li>
<li class="chapter" data-level="7.3.3" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#exercise"><i class="fa fa-check"></i><b>7.3.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#take-home-message"><i class="fa fa-check"></i><b>7.4</b> Take home message</a></li>
<li class="chapter" data-level="7.5" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#attributions_w07"><i class="fa fa-check"></i><b>7.5</b> Attributions</a></li>
</ul></li>
<li class="part"><span><b>Data Sciencist’s Toolbox</b></span></li>
<li class="chapter" data-level="8" data-path="unix-tools.html"><a href="unix-tools.html"><i class="fa fa-check"></i><b>8</b> Unix tools</a>
<ul>
<li class="chapter" data-level="8.1" data-path="unix-tools.html"><a href="unix-tools.html#intro-w08"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="unix-tools.html"><a href="unix-tools.html#reading-list-w08"><i class="fa fa-check"></i><b>8.1.1</b> Reading list</a></li>
<li class="chapter" data-level="8.1.2" data-path="statistical-inference-and-causality.html"><a href="statistical-inference-and-causality.html#technical-help-session"><i class="fa fa-check"></i><b>8.1.2</b> Technical Help session</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="unix-tools.html"><a href="unix-tools.html#bourne-again-shell-bash"><i class="fa fa-check"></i><b>8.2</b> Bourne Again SHell (BASH)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="unix-tools.html"><a href="unix-tools.html#installation"><i class="fa fa-check"></i><b>8.2.1</b> Installation</a></li>
<li class="chapter" data-level="8.2.2" data-path="unix-tools.html"><a href="unix-tools.html#getting-started"><i class="fa fa-check"></i><b>8.2.2</b> Getting started</a></li>
<li class="chapter" data-level="8.2.3" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#exercise"><i class="fa fa-check"></i><b>8.2.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="unix-tools.html"><a href="unix-tools.html#text-editing"><i class="fa fa-check"></i><b>8.3</b> Text editing</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="unix-tools.html"><a href="unix-tools.html#exercise-1"><i class="fa fa-check"></i><b>8.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="unix-tools.html"><a href="unix-tools.html#data-wrangling"><i class="fa fa-check"></i><b>8.4</b> Data wrangling</a></li>
<li class="chapter" data-level="8.5" data-path="unix-tools.html"><a href="unix-tools.html#copying-data"><i class="fa fa-check"></i><b>8.5</b> Copying data</a></li>
<li class="chapter" data-level="8.6" data-path="unix-tools.html"><a href="unix-tools.html#web"><i class="fa fa-check"></i><b>8.6</b> Web</a>
<ul>
<li class="chapter" data-level="" data-path="unix-tools.html"><a href="unix-tools.html#assignment"><i class="fa fa-check"></i>Assignment</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="spatial-temporal-mobility-analysis.html"><a href="spatial-temporal-mobility-analysis.html#take-home-message"><i class="fa fa-check"></i><b>8.7</b> Take home message</a></li>
<li class="chapter" data-level="8.8" data-path="unix-tools.html"><a href="unix-tools.html#attributions_w08"><i class="fa fa-check"></i><b>8.8</b> Attributions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="web-visualisation.html"><a href="web-visualisation.html"><i class="fa fa-check"></i><b>9</b> Web Visualisation</a></li>
<li class="part"><span><b>Future</b></span></li>
<li class="chapter" data-level="10" data-path="a-look-into-the-future.html"><a href="a-look-into-the-future.html"><i class="fa fa-check"></i><b>10</b> A look into the future</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEOG0125: Advanced Topics in Social and Geographic Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-temporal-mobility-analysis" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Spatial-Temporal Mobility Analysis</h1>
<div id="intro-w07" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p>Against the background of unprecedented growth in private vehicle ownership and the entrenchment of the private car in everyday life, the past decades have seen a growing and ongoing academic and policy debate on how to encourage individuals to change to more sustainable ways of travelling. More recently, researchers have started to build on so-called location-aware technologies, exploring innovative methods to more accurately capture, visualise, and analyse individual spatiotemporal travel patterns: information that can be used to formulate strategies to accommodate the increasing demand for transport vis-à-vis growing environmental and societal concerns.</p>
<p>This week we will be looking at capturing mobility data with Global Positioning Systems. We will further use two types of Machine Learning classifiers, specifically Support Vector Machines and tree-based methods, to classify labeled GPS data into <em>stay</em> and <em>move</em> points. This week is structured around three short videos as well as a tutorial in R with a ‘hands-on’ application of GPS data classification.</p>
<p>Let’s get to it!</p>
<div id="video-introduction-w07" class="section level4 unnumbered">
<h4>Video: Introduction W07</h4>
<p><div class="vembedr" align="left">
<div>
<iframe src="https://web.microsoftstream.com/embed/video/3a62bfb5-4598-4079-a14e-4ed2708c08c6?autoplay=false&amp;showinfo=true" width="533" height="300" style="border:none;"></iframe>
</div>
</div>
[Lecture slides] <a href="https://web.microsoftstream.com/video/3a62bfb5-4598-4079-a14e-4ed2708c08c6">[Watch on MS stream]</a></p>
</div>
<div id="reading-list-w07" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Reading list</h3>
<p>Please find the reading list for this week below.</p>
<div id="core-reading" class="section level4 unnumbered">
<h4>Core reading</h4>
<ul>
<li>Broach, J. <em>et al.</em>. 2019. Travel mode imputation using GPS and accelerometer data from a multi-day travel survey. <em>Journal of Transport Geography</em> 78: 194-204. <a href="https://doi.org/10.1016/j.jtrangeo.2019.06.001">[Link]</a></li>
<li>Bohte, W. and K. Maat. 2009. Deriving and validating trip purposes and travel modes for multi-day GPS-based travel surveys: A large-scale application in the Netherlands. <em>Transportation Research Part C: Emerging Technologies</em> 17(3): 285–297. <a href="https://doi.org/10.1016/j.trc.2008.11.004">[Link]</a></li>
<li>Feng, T and H. Timmermans. 2016. Comparison of advanced imputation algorithms for detection of transportation mode and activity episode using GPS data. <em>Transportation Planning and Technology</em> 39(2): 180–194. <a href="https://doi.org/10.1080/03081060.2015.1127540">[Link]</a></li>
<li>Nitsche, P. <em>et al.</em>. 2014. Supporting large-scale travel surveys with smartphones - a practical approach. <em>Transportation Research Part C: Emerging Technologies</em> 43: 212–221. <a href="https://doi.org/10.1016/j.trc.2013.11.005">[Link]</a></li>
</ul>
</div>
<div id="supplementary-reading" class="section level4 unnumbered">
<h4>Supplementary reading</h4>
<ul>
<li>Behrens, R. <em>et al.</em>. 2006. Collection of passenger travel data in Sub-Saharan African cities: Towards improving survey instruments and procedures. <em>Transport Policy</em> 13: 85-96. <a href="https://doi.org/10.1016/j.tranpol.2005.09.003">[Link]</a></li>
<li>Behrens, R. and Del Mistro, R. 2010. Shocking habits: Methodological issues in analyzing changing personal travel
behavior over time. <em>International Journal of Sustainable Transportation</em> 4(5): 253-271. <a href="http://dx.doi.org/10.1080/15568310903145170">[Link]</a></li>
<li>Van de Coevering, P. <em>et al.</em>. 2021. Causes and effects between attitudes, the built environment and car kilometres: A longitudinal analysis. <em>Journal of Transport Geography</em> 91: 102982. <a href="https://doi.org/10.1016/j.jtrangeo.2021.102982">[Link]</a></li>
<li>Van Dijk, J. 2018. Identifying activity-travel points from GPS-data with multiple moving windows. <em>Computers, Environment and Urban Systems</em> 70: 84-101. <a href="https://doi.org/10.1016/j.compenvurbsys.2018.02.004">[Link]</a></li>
<li>Wolf, J. 2000. Using GPS data loggers to replace travel diaries in the collection of travel data. <em>Doctoral dissertation</em>. Atlanta, Georgia: Georgia Institute of Technology. <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.126.3799&amp;rep=rep1&amp;type=pdf">[Link]</a></li>
</ul>
</div>
</div>
<div id="technical-help-session" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Technical Help session</h3>
<p>Every Thursday between 13h00-14h00 you can join the <strong>Technical Help</strong> session on Microsoft Teams. The session will be hosted by <a href="https://www.ucl.ac.uk/geospatial-analytics/people/alfie-long">Alfie</a>. He will be there for the whole hour to answer any question you have live in the meeting or any questions you have formulated beforehand. If you cannot make the meeting, feel free to post the issue you are having in the Technical Help channel on the GEOG0125 Team so that Alfie can help to find a solution.</p>
</div>
</div>
<div id="gps-data" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> GPS data</h2>
<p>Mobility is a central aspect of everyday life. In its simplest form, human mobility refers to the movement of individuals from location <strong>A</strong> to location <strong>B</strong>. This can be a relocation from one city to another city, as well as a trip from home to work. Transport systems provide the physical nodes and linkages that facilitate this mobility. However, transport systems and road networks in many cities around the world are under pressure as a result of unparalleled growth in private vehicle ownership and increasingly complex and fragmented travel patterns. Particularly in urban areas, this is problematic because it leads to problems such as congestion, accidents, road decay, and reduced accessibility. As such, governments and researchers throughout the world have started to recognise the need to curtail demand for private road transport.</p>
<blockquote>
<p>“Technological breakthroughs [alone] are not going to provide the silver bullet for the mitigation of climate change and energy security threats caused by the transport sector” (<a href="https://www.wiley.com/en-gb/Transport+Geographies%3A+Mobilities%2C+Flows+and+Spaces-p-9781405153225">Stradling and Anable, 2008: 195</a>)</p>
</blockquote>
<p>The realisation that increasing road infrastructure and improvements in car technology are not sufficient to address the transport problems around the world has led to the idea that transport planning should shift from supply-side to demand-side passenger transport planning. For this, accurate data are required on individual spatio-temporal behaviour.</p>
<p>Travel data collection methods can roughly be classified into two, not per se mutually exclusive, methods. The first method uses self-reported data, such as data collected through telephone-assisted interviews, computer-assisted interviews, and pen-and-paper interviews. The second method relies on passively collected data, such as data collected through call-detail records and GPS data. Technological developments in the field of location-aware technologies, GPS in particular, have greatly enhanced opportunities to collect accurate data on human spatiotemporal behaviour. GPS data need to be collected and analysed systematically to be intelligible for transport researchers and policy makers. Moreover, the challenges inherent to mobile data collection techniques include not only harnessing the tools to obtain geo-referenced data, but also the development of new skills sets for cleaning, analysing, and interpreting these data.</p>
<div id="video-gps-data-in-transport-research" class="section level4 unnumbered">
<h4>Video: GPS data in transport research</h4>
<p><div class="vembedr" align="left">
<div>
<iframe src="https://web.microsoftstream.com/embed/video/de09a1f1-7293-4d92-82eb-1233571aa808?autoplay=false&amp;showinfo=true" width="533" height="300" style="border:none;"></iframe>
</div>
</div>
<a href="https://github.com/jtvandijk/GEOG0125/blob/master/slides/w07/w07_01_gps_data.pdf">[Lecture slides]</a> <a href="https://web.microsoftstream.com/video/de09a1f1-7293-4d92-82eb-1233571aa808">[Watch on MS stream]</a></p>
</div>
</div>
<div id="gps-data-classification" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> GPS data classification</h2>
<p>Where GPS technology can precisely register the spatiotemporal elements of activity-travel behaviour, travel characteristics need to be imputed from the data. As such, throughout the last decade or so, a plethora of methods has been developed for identifying trips, activities, and travel modes from raw GPS trajectories. These methods range from deterministic (rule-based) methods to advanced machine learning algorithms. Here, we will focus on using two types of machine learning techniques (Support Vector Machines and tree-based methods) to classify labelled GPS points into <em>stay</em> and <em>move</em> points.</p>
<div id="video-gps-data-classification-with-ml-techniques" class="section level4 unnumbered">
<h4>Video: GPS data classification with ML techniques</h4>
<p><div class="vembedr" align="left">
<div>
<iframe src="https://web.microsoftstream.com/embed/video/44eb5e0a-4f8f-4464-9c14-d5fe7c91a619?autoplay=false&amp;showinfo=true" width="533" height="300" style="border:none;"></iframe>
</div>
</div>
<a href="https://github.com/jtvandijk/GEOG0125/blob/master/slides/w07/w07_02_gps_data_classification.pdf">[Lecture slides]</a> <a href="https://web.microsoftstream.com/video/44eb5e0a-4f8f-4464-9c14-d5fe7c91a619">[Watch on MS stream]</a></p>
<p>The segmentation of GPS data into activity and travel episodes is often the first step in a more elaborate process of identifying activity types and transport modes. A major issue with GPS data imputation, however, is the necessity of a ground truth to test whether the imputation algorithm correctly categorises GPS points into activity (<em>stay</em>) points and trips (<em>move</em>) points. We will be using a set of <a href="https://doi.org/10.1016/j.compenvurbsys.2018.02.004">50 artificially created GPS trajectories</a> that all contain a sequence of stays and moves in Cape Town, South Africa. For the data that we will use, the artificial GPS ‘records’ a measurement every 60 seconds. To further simulate noise in the data, a random sample comprising of 50 per cent of the data points was taken. Besides these raw GPS data, we also have access to a basic road network lay out of the <a href="https://www.capetownmagazine.com/cape-town#:~:text=A%20more%20commonly%2Dused%20nickname,visitors%20to%20Cape%20Town%20alike.">Mother City</a>.</p>
</div>
<div id="file-download" class="section level4 unnumbered">
<h4>File download</h4>
<table>
<thead>
<tr class="header">
<th align="left">File</th>
<th align="left">Type</th>
<th align="left">Link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Cape Town GPS and road data</td>
<td align="left"><code>shp</code></td>
<td align="left"><a href="https://github.com/jtvandijk/GEOG0125/tree/master/raw/zip/cape_town.zip">Download</a></td>
</tr>
</tbody>
</table>
<p>We will start by downloading the files, importing both into R, and looking at what we will be working with. Be careful <em>not</em> to plot the road network file. Because the road network contains around 120,000 individual road segments it will take a long time to draw. Rather have a look at the data in <a href="https://www.qgis.org/en/site/">QGIS</a>, which is much more capable of on the fly displaying a large number of features.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="spatial-temporal-mobility-analysis.html#cb24-1" aria-hidden="true"></a><span class="co"># load libraries</span></span>
<span id="cb24-2"><a href="spatial-temporal-mobility-analysis.html#cb24-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb24-3"><a href="spatial-temporal-mobility-analysis.html#cb24-3" aria-hidden="true"></a><span class="kw">library</span>(sf)</span>
<span id="cb24-4"><a href="spatial-temporal-mobility-analysis.html#cb24-4" aria-hidden="true"></a><span class="kw">library</span>(tmap)</span>
<span id="cb24-5"><a href="spatial-temporal-mobility-analysis.html#cb24-5" aria-hidden="true"></a></span>
<span id="cb24-6"><a href="spatial-temporal-mobility-analysis.html#cb24-6" aria-hidden="true"></a><span class="co"># read gps data</span></span>
<span id="cb24-7"><a href="spatial-temporal-mobility-analysis.html#cb24-7" aria-hidden="true"></a>gps &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&#39;raw/w07/gps_cape_town.shp&#39;</span>)</span>
<span id="cb24-8"><a href="spatial-temporal-mobility-analysis.html#cb24-8" aria-hidden="true"></a></span>
<span id="cb24-9"><a href="spatial-temporal-mobility-analysis.html#cb24-9" aria-hidden="true"></a><span class="co"># read road data</span></span>
<span id="cb24-10"><a href="spatial-temporal-mobility-analysis.html#cb24-10" aria-hidden="true"></a>road &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&#39;raw/w07/roads_cape_town.shp&#39;</span>)</span>
<span id="cb24-11"><a href="spatial-temporal-mobility-analysis.html#cb24-11" aria-hidden="true"></a></span>
<span id="cb24-12"><a href="spatial-temporal-mobility-analysis.html#cb24-12" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb24-13"><a href="spatial-temporal-mobility-analysis.html#cb24-13" aria-hidden="true"></a>gps</span></code></pre></div>
<pre><code>## Simple feature collection with 27019 features and 9 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 18.34291 ymin: -34.19419 xmax: 19.06105 ymax: -33.66433
## CRS:            4148
## # A tibble: 27,019 x 10
##     stop type  duration point_id_n timestamp mode  track_id move  activity
##    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   
##  1     1 MEDI…       30          1 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  2     1 MEDI…       30          2 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  3     1 MEDI…       30          5 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  4     1 MEDI…       30          9 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  5     1 MEDI…       30         10 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  6     1 MEDI…       30         12 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  7     1 MEDI…       30         14 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  8     1 MEDI…       30         16 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  9     1 MEDI…       30         18 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## 10     1 MEDI…       30         22 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## # … with 27,009 more rows, and 1 more variable: geometry &lt;POINT [°]&gt;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="spatial-temporal-mobility-analysis.html#cb26-1" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb26-2"><a href="spatial-temporal-mobility-analysis.html#cb26-2" aria-hidden="true"></a>road</span></code></pre></div>
<pre><code>## Simple feature collection with 125024 features and 1 field
## geometry type:  LINESTRING
## dimension:      XY
## bbox:           xmin: 18.34051 ymin: -34.3001 xmax: 19.12007 ymax: -33.62755
## CRS:            4148
## # A tibble: 125,024 x 2
##       id                                                           geometry
##    &lt;dbl&gt;                                                   &lt;LINESTRING [°]&gt;
##  1     1 (18.93353 -34.16301, 18.93345 -34.1631, 18.93335 -34.16318, 18.93…
##  2     2 (18.45615 -34.27366, 18.4545 -34.27321, 18.45298 -34.2728, 18.452…
##  3     3 (18.45615 -34.27366, 18.45674 -34.27201, 18.45683 -34.27181, 18.4…
##  4     4 (18.85612 -34.25045, 18.85621 -34.2506, 18.85633 -34.25087, 18.85…
##  5     5 (19.12007 -34.25944, 19.11977 -34.25952, 19.11936 -34.25961, 19.1…
##  6     6 (18.50105 -33.98948, 18.50102 -33.98942, 18.50105 -33.98935, 18.5…
##  7     7 (18.65381 -34.00991, 18.65355 -34.00979, 18.65251 -34.00931, 18.6…
##  8     8 (18.63738 -34.07209, 18.63846 -34.07193, 18.63924 -34.07183, 18.6…
##  9     9 (18.44389 -34.03779, 18.44389 -34.03798, 18.44388 -34.03826, 18.4…
## 10    10 (18.64958 -34.04498, 18.64729 -34.04547, 18.64228 -34.04652, 18.6…
## # … with 125,014 more rows</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="spatial-temporal-mobility-analysis.html#cb28-1" aria-hidden="true"></a><span class="co"># inspect </span></span>
<span id="cb28-2"><a href="spatial-temporal-mobility-analysis.html#cb28-2" aria-hidden="true"></a><span class="kw">names</span>(gps)</span></code></pre></div>
<pre><code>##  [1] &quot;stop&quot;       &quot;type&quot;       &quot;duration&quot;   &quot;point_id_n&quot; &quot;timestamp&quot; 
##  [6] &quot;mode&quot;       &quot;track_id&quot;   &quot;move&quot;       &quot;activity&quot;   &quot;geometry&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="spatial-temporal-mobility-analysis.html#cb30-1" aria-hidden="true"></a><span class="co"># project into Hartbeesthoek94</span></span>
<span id="cb30-2"><a href="spatial-temporal-mobility-analysis.html#cb30-2" aria-hidden="true"></a>gps &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_transform</span>(<span class="dt">crs=</span><span class="st">&#39;epsg:2053&#39;</span>)</span>
<span id="cb30-3"><a href="spatial-temporal-mobility-analysis.html#cb30-3" aria-hidden="true"></a>road &lt;-<span class="st"> </span>road <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_transform</span>(<span class="dt">crs=</span><span class="st">&#39;epsg:2053&#39;</span>)</span>
<span id="cb30-4"><a href="spatial-temporal-mobility-analysis.html#cb30-4" aria-hidden="true"></a></span>
<span id="cb30-5"><a href="spatial-temporal-mobility-analysis.html#cb30-5" aria-hidden="true"></a><span class="co"># plot gps points</span></span>
<span id="cb30-6"><a href="spatial-temporal-mobility-analysis.html#cb30-6" aria-hidden="true"></a><span class="kw">tm_shape</span>(gps) <span class="op">+</span></span>
<span id="cb30-7"><a href="spatial-temporal-mobility-analysis.html#cb30-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">tm_dots</span>()</span></code></pre></div>
<p><img src="GEOG0125_files/figure-html/07-load-libraries-1.png" width="672" /></p>
<p>The road network file is relatively simple and only contains road network segments - no additional information (e.g. maximum speed, road type, etc.) is available. The GPS data themselves contain several fields:</p>
<table>
<thead>
<tr class="header">
<th align="left">Column heading</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>stop</em></td>
<td align="left">Stop number within GPS trajectory</td>
</tr>
<tr class="even">
<td align="left"><em>type</em></td>
<td align="left">Type of stop (i.e. short, medium, long)</td>
</tr>
<tr class="odd">
<td align="left"><em>duration</em></td>
<td align="left">Duration of stop in seconds</td>
</tr>
<tr class="even">
<td align="left"><em>point_id_n</em></td>
<td align="left">Unique point identifier within GPS trajectory</td>
</tr>
<tr class="odd">
<td align="left"><em>timestamp</em></td>
<td align="left">Time the point was recorded</td>
</tr>
<tr class="even">
<td align="left"><em>mode</em></td>
<td align="left">Travel mode</td>
</tr>
<tr class="odd">
<td align="left"><em>track_id</em></td>
<td align="left">Unique ID for GPS trajectory</td>
</tr>
<tr class="even">
<td align="left"><em>move</em></td>
<td align="left">Whether point is a move or a stay</td>
</tr>
<tr class="odd">
<td align="left"><em>activity</em></td>
<td align="left">Whether point is a move (including mode) or a stay</td>
</tr>
</tbody>
</table>
</div>
<div id="gps-data-preparation" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> GPS data preparation</h3>
<p>The <em>move</em> variable is the variable we will try to predict. Before we split our data into a <em>train</em> and <em>test</em> set, however, we will need to derive some features from our raw GPS data that we can use as our input features: speed, point density, and distance to nearest road segment. As we want to derive information of consecutive measurements, the order of the data is very important right now as the points form a trajectory: so before we calculate anything we start by making sure that the data are ordered correctly: by <em>track_id</em> and <em>timestamp</em>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="spatial-temporal-mobility-analysis.html#cb31-1" aria-hidden="true"></a><span class="co"># order data so that we do not mix separate trajectories</span></span>
<span id="cb31-2"><a href="spatial-temporal-mobility-analysis.html#cb31-2" aria-hidden="true"></a>gps &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(track_id,timestamp)</span>
<span id="cb31-3"><a href="spatial-temporal-mobility-analysis.html#cb31-3" aria-hidden="true"></a></span>
<span id="cb31-4"><a href="spatial-temporal-mobility-analysis.html#cb31-4" aria-hidden="true"></a><span class="co"># calculate distance between consecutive points // could take a few minutes</span></span>
<span id="cb31-5"><a href="spatial-temporal-mobility-analysis.html#cb31-5" aria-hidden="true"></a>gps &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-6"><a href="spatial-temporal-mobility-analysis.html#cb31-6" aria-hidden="true"></a><span class="st">         </span><span class="kw">group_by</span>(track_id) <span class="op">%&gt;%</span></span>
<span id="cb31-7"><a href="spatial-temporal-mobility-analysis.html#cb31-7" aria-hidden="true"></a><span class="st">         </span><span class="kw">mutate</span>(</span>
<span id="cb31-8"><a href="spatial-temporal-mobility-analysis.html#cb31-8" aria-hidden="true"></a>                <span class="dt">lead_geom =</span> geometry[<span class="kw">row_number</span>() <span class="op">+</span><span class="st"> </span><span class="dv">1</span>],</span>
<span id="cb31-9"><a href="spatial-temporal-mobility-analysis.html#cb31-9" aria-hidden="true"></a>                <span class="dt">dist =</span> <span class="kw">st_distance</span>(lead_geom,geometry, <span class="dt">by_element=</span><span class="ot">TRUE</span>, <span class="dt">which=</span><span class="st">&#39;Euclidean&#39;</span>)</span>
<span id="cb31-10"><a href="spatial-temporal-mobility-analysis.html#cb31-10" aria-hidden="true"></a>                ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-11"><a href="spatial-temporal-mobility-analysis.html#cb31-11" aria-hidden="true"></a><span class="st">        </span><span class="kw">ungroup</span>()</span>
<span id="cb31-12"><a href="spatial-temporal-mobility-analysis.html#cb31-12" aria-hidden="true"></a></span>
<span id="cb31-13"><a href="spatial-temporal-mobility-analysis.html#cb31-13" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb31-14"><a href="spatial-temporal-mobility-analysis.html#cb31-14" aria-hidden="true"></a>gps</span></code></pre></div>
<pre><code>## Simple feature collection with 27019 features and 10 fields
## Active geometry column: geometry
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 918250.7 ymin: 3775604 xmax: 986130.2 ymax: 3836086
## CRS:            epsg:2053
## # A tibble: 27,019 x 12
##     stop type  duration point_id_n timestamp mode  track_id move  activity
##    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   
##  1     1 MEDI…       30          1 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  2     1 MEDI…       30          2 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  3     1 MEDI…       30          5 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  4     1 MEDI…       30          9 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  5     1 MEDI…       30         10 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  6     1 MEDI…       30         12 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  7     1 MEDI…       30         14 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  8     1 MEDI…       30         16 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  9     1 MEDI…       30         18 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## 10     1 MEDI…       30         22 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## # … with 27,009 more rows, and 3 more variables: geometry &lt;POINT [m]&gt;,
## #   lead_geom &lt;POINT [m]&gt;, dist [m]</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="spatial-temporal-mobility-analysis.html#cb33-1" aria-hidden="true"></a><span class="co"># calculate time between consecutive points </span></span>
<span id="cb33-2"><a href="spatial-temporal-mobility-analysis.html#cb33-2" aria-hidden="true"></a>gps &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-3"><a href="spatial-temporal-mobility-analysis.html#cb33-3" aria-hidden="true"></a><span class="st">        </span><span class="kw">group_by</span>(track_id) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-4"><a href="spatial-temporal-mobility-analysis.html#cb33-4" aria-hidden="true"></a><span class="st">        </span><span class="kw">mutate</span>(</span>
<span id="cb33-5"><a href="spatial-temporal-mobility-analysis.html#cb33-5" aria-hidden="true"></a>                <span class="dt">lead_time =</span> <span class="kw">strptime</span>(timestamp[<span class="kw">row_number</span>() <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], <span class="dt">format=</span><span class="st">&#39;%d/%m/%Y %H:%M:%S&#39;</span>),</span>
<span id="cb33-6"><a href="spatial-temporal-mobility-analysis.html#cb33-6" aria-hidden="true"></a>                <span class="dt">diff =</span> <span class="kw">difftime</span>(lead_time,<span class="kw">strptime</span>(timestamp, <span class="dt">format=</span><span class="st">&#39;%d/%m/%Y %H:%M:%S&#39;</span>), <span class="dt">units=</span><span class="st">&#39;secs&#39;</span>)</span>
<span id="cb33-7"><a href="spatial-temporal-mobility-analysis.html#cb33-7" aria-hidden="true"></a>                ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-8"><a href="spatial-temporal-mobility-analysis.html#cb33-8" aria-hidden="true"></a><span class="st">        </span><span class="kw">ungroup</span>()</span>
<span id="cb33-9"><a href="spatial-temporal-mobility-analysis.html#cb33-9" aria-hidden="true"></a></span>
<span id="cb33-10"><a href="spatial-temporal-mobility-analysis.html#cb33-10" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb33-11"><a href="spatial-temporal-mobility-analysis.html#cb33-11" aria-hidden="true"></a>gps</span></code></pre></div>
<pre><code>## Simple feature collection with 27019 features and 12 fields
## Active geometry column: geometry
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 918250.7 ymin: 3775604 xmax: 986130.2 ymax: 3836086
## CRS:            epsg:2053
## # A tibble: 27,019 x 14
##     stop type  duration point_id_n timestamp mode  track_id move  activity
##    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   
##  1     1 MEDI…       30          1 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  2     1 MEDI…       30          2 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  3     1 MEDI…       30          5 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  4     1 MEDI…       30          9 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  5     1 MEDI…       30         10 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  6     1 MEDI…       30         12 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  7     1 MEDI…       30         14 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  8     1 MEDI…       30         16 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  9     1 MEDI…       30         18 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## 10     1 MEDI…       30         22 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## # … with 27,009 more rows, and 5 more variables: geometry &lt;POINT [m]&gt;,
## #   lead_geom &lt;POINT [m]&gt;, dist [m], lead_time &lt;dttm&gt;, diff &lt;drtn&gt;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="spatial-temporal-mobility-analysis.html#cb35-1" aria-hidden="true"></a><span class="co"># calculate speed in kilometres per hour</span></span>
<span id="cb35-2"><a href="spatial-temporal-mobility-analysis.html#cb35-2" aria-hidden="true"></a>gps &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">speed =</span> <span class="kw">as.integer</span>(dist)<span class="op">/</span><span class="kw">as.integer</span>(diff)<span class="op">*</span><span class="fl">3.6</span>)</span>
<span id="cb35-3"><a href="spatial-temporal-mobility-analysis.html#cb35-3" aria-hidden="true"></a></span>
<span id="cb35-4"><a href="spatial-temporal-mobility-analysis.html#cb35-4" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb35-5"><a href="spatial-temporal-mobility-analysis.html#cb35-5" aria-hidden="true"></a>gps</span></code></pre></div>
<pre><code>## Simple feature collection with 27019 features and 13 fields
## Active geometry column: geometry
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 918250.7 ymin: 3775604 xmax: 986130.2 ymax: 3836086
## CRS:            epsg:2053
## # A tibble: 27,019 x 15
##     stop type  duration point_id_n timestamp mode  track_id move  activity
##  * &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   
##  1     1 MEDI…       30          1 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  2     1 MEDI…       30          2 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  3     1 MEDI…       30          5 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  4     1 MEDI…       30          9 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  5     1 MEDI…       30         10 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  6     1 MEDI…       30         12 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  7     1 MEDI…       30         14 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  8     1 MEDI…       30         16 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  9     1 MEDI…       30         18 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## 10     1 MEDI…       30         22 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## # … with 27,009 more rows, and 6 more variables: geometry &lt;POINT [m]&gt;,
## #   lead_geom &lt;POINT [m]&gt;, dist [m], lead_time &lt;dttm&gt;, diff &lt;drtn&gt;,
## #   speed &lt;dbl&gt;</code></pre>
<p>Because we are using consecutive rows to calculate our speed, all of the last measurements within each of the 50 trajectories will not be assigned a value. However, because we do not really want to throw these points out, we will simply assign these points the same speed value as the last point that did get a value assigned.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="spatial-temporal-mobility-analysis.html#cb37-1" aria-hidden="true"></a><span class="co"># fill missing speeds</span></span>
<span id="cb37-2"><a href="spatial-temporal-mobility-analysis.html#cb37-2" aria-hidden="true"></a>gps &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fill</span>(speed, <span class="dt">.direction=</span><span class="st">&#39;down&#39;</span>)</span></code></pre></div>
<p>Another useful input feature would be a local point density: for each point it would be useful to know how many other points are in its vicinity, for instance, because a clustering of points could be indicative of an activity. Because vicinity is difficult to define, we will use three distance thresholds to create these local point densities: 100m, 250m, and 500m.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="spatial-temporal-mobility-analysis.html#cb38-1" aria-hidden="true"></a><span class="co"># distance thresholds</span></span>
<span id="cb38-2"><a href="spatial-temporal-mobility-analysis.html#cb38-2" aria-hidden="true"></a>gps_100m &lt;-<span class="st"> </span><span class="kw">st_buffer</span>(gps,<span class="dv">100</span>)</span>
<span id="cb38-3"><a href="spatial-temporal-mobility-analysis.html#cb38-3" aria-hidden="true"></a>gps_250m &lt;-<span class="st"> </span><span class="kw">st_buffer</span>(gps,<span class="dv">250</span>)</span>
<span id="cb38-4"><a href="spatial-temporal-mobility-analysis.html#cb38-4" aria-hidden="true"></a>gps_500m &lt;-<span class="st"> </span><span class="kw">st_buffer</span>(gps,<span class="dv">500</span>)</span>
<span id="cb38-5"><a href="spatial-temporal-mobility-analysis.html#cb38-5" aria-hidden="true"></a></span>
<span id="cb38-6"><a href="spatial-temporal-mobility-analysis.html#cb38-6" aria-hidden="true"></a><span class="co"># loop through trajectories and count the number of points falling within the three distance thresholds </span></span>
<span id="cb38-7"><a href="spatial-temporal-mobility-analysis.html#cb38-7" aria-hidden="true"></a><span class="co"># // this could take a few minutes</span></span>
<span id="cb38-8"><a href="spatial-temporal-mobility-analysis.html#cb38-8" aria-hidden="true"></a>df &lt;-<span class="st"> </span>gps[<span class="dv">0</span>,]</span>
<span id="cb38-9"><a href="spatial-temporal-mobility-analysis.html#cb38-9" aria-hidden="true"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>)) {</span>
<span id="cb38-10"><a href="spatial-temporal-mobility-analysis.html#cb38-10" aria-hidden="true"></a></span>
<span id="cb38-11"><a href="spatial-temporal-mobility-analysis.html#cb38-11" aria-hidden="true"></a>        <span class="co"># filter gps trajectory</span></span>
<span id="cb38-12"><a href="spatial-temporal-mobility-analysis.html#cb38-12" aria-hidden="true"></a>        gps_sel &lt;-<span class="st"> </span><span class="kw">filter</span>(gps, <span class="kw">as.integer</span>(track_id)<span class="op">==</span>t)</span>
<span id="cb38-13"><a href="spatial-temporal-mobility-analysis.html#cb38-13" aria-hidden="true"></a>        </span>
<span id="cb38-14"><a href="spatial-temporal-mobility-analysis.html#cb38-14" aria-hidden="true"></a>        <span class="co"># filter buffer</span></span>
<span id="cb38-15"><a href="spatial-temporal-mobility-analysis.html#cb38-15" aria-hidden="true"></a>        gps_100m_sel &lt;-<span class="st"> </span><span class="kw">filter</span>(gps_100m, <span class="kw">as.integer</span>(track_id)<span class="op">==</span>t)</span>
<span id="cb38-16"><a href="spatial-temporal-mobility-analysis.html#cb38-16" aria-hidden="true"></a>        gps_250m_sel &lt;-<span class="st"> </span><span class="kw">filter</span>(gps_250m, <span class="kw">as.integer</span>(track_id)<span class="op">==</span>t)</span>
<span id="cb38-17"><a href="spatial-temporal-mobility-analysis.html#cb38-17" aria-hidden="true"></a>        gps_500m_sel &lt;-<span class="st"> </span><span class="kw">filter</span>(gps_500m, <span class="kw">as.integer</span>(track_id)<span class="op">==</span>t)</span>
<span id="cb38-18"><a href="spatial-temporal-mobility-analysis.html#cb38-18" aria-hidden="true"></a>        </span>
<span id="cb38-19"><a href="spatial-temporal-mobility-analysis.html#cb38-19" aria-hidden="true"></a>        <span class="co"># intersect</span></span>
<span id="cb38-20"><a href="spatial-temporal-mobility-analysis.html#cb38-20" aria-hidden="true"></a>        gps_sel<span class="op">$</span>buf100 &lt;-<span class="st"> </span><span class="kw">lengths</span>(<span class="kw">st_intersects</span>(gps_sel, gps_100m_sel))</span>
<span id="cb38-21"><a href="spatial-temporal-mobility-analysis.html#cb38-21" aria-hidden="true"></a>        gps_sel<span class="op">$</span>buf250 &lt;-<span class="st"> </span><span class="kw">lengths</span>(<span class="kw">st_intersects</span>(gps_sel, gps_250m_sel))</span>
<span id="cb38-22"><a href="spatial-temporal-mobility-analysis.html#cb38-22" aria-hidden="true"></a>        gps_sel<span class="op">$</span>buf500 &lt;-<span class="st"> </span><span class="kw">lengths</span>(<span class="kw">st_intersects</span>(gps_sel, gps_500m_sel))</span>
<span id="cb38-23"><a href="spatial-temporal-mobility-analysis.html#cb38-23" aria-hidden="true"></a>        </span>
<span id="cb38-24"><a href="spatial-temporal-mobility-analysis.html#cb38-24" aria-hidden="true"></a>        <span class="co"># bind results </span></span>
<span id="cb38-25"><a href="spatial-temporal-mobility-analysis.html#cb38-25" aria-hidden="true"></a>        df &lt;-<span class="st"> </span><span class="kw">rbind</span>(df,gps_sel)</span>
<span id="cb38-26"><a href="spatial-temporal-mobility-analysis.html#cb38-26" aria-hidden="true"></a></span>
<span id="cb38-27"><a href="spatial-temporal-mobility-analysis.html#cb38-27" aria-hidden="true"></a>}</span>
<span id="cb38-28"><a href="spatial-temporal-mobility-analysis.html#cb38-28" aria-hidden="true"></a></span>
<span id="cb38-29"><a href="spatial-temporal-mobility-analysis.html#cb38-29" aria-hidden="true"></a><span class="co"># rename</span></span>
<span id="cb38-30"><a href="spatial-temporal-mobility-analysis.html#cb38-30" aria-hidden="true"></a>gps &lt;-<span class="st"> </span>df</span>
<span id="cb38-31"><a href="spatial-temporal-mobility-analysis.html#cb38-31" aria-hidden="true"></a></span>
<span id="cb38-32"><a href="spatial-temporal-mobility-analysis.html#cb38-32" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb38-33"><a href="spatial-temporal-mobility-analysis.html#cb38-33" aria-hidden="true"></a>gps</span></code></pre></div>
<pre><code>## Simple feature collection with 27019 features and 16 fields
## Active geometry column: geometry
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 918250.7 ymin: 3775604 xmax: 986130.2 ymax: 3836086
## CRS:            epsg:2053
## # A tibble: 27,019 x 18
##     stop type  duration point_id_n timestamp mode  track_id move  activity
##  * &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   
##  1     1 MEDI…       30          1 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  2     1 MEDI…       30          2 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  3     1 MEDI…       30          5 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  4     1 MEDI…       30          9 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  5     1 MEDI…       30         10 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  6     1 MEDI…       30         12 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  7     1 MEDI…       30         14 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  8     1 MEDI…       30         16 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  9     1 MEDI…       30         18 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## 10     1 MEDI…       30         22 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## # … with 27,009 more rows, and 9 more variables: geometry &lt;POINT [m]&gt;,
## #   lead_geom &lt;POINT [m]&gt;, dist [m], lead_time &lt;dttm&gt;, diff &lt;drtn&gt;,
## #   speed &lt;dbl&gt;, buf100 &lt;int&gt;, buf250 &lt;int&gt;, buf500 &lt;int&gt;</code></pre>
<p>Great. We now have a speed variable as well as three local density variables. The last thing we will need to do is for each point calculate the distance to the nearest road segment.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="spatial-temporal-mobility-analysis.html#cb40-1" aria-hidden="true"></a><span class="co"># for each point: get nearest road feature </span></span>
<span id="cb40-2"><a href="spatial-temporal-mobility-analysis.html#cb40-2" aria-hidden="true"></a><span class="co"># // this could take a few minutes</span></span>
<span id="cb40-3"><a href="spatial-temporal-mobility-analysis.html#cb40-3" aria-hidden="true"></a>nearest_road &lt;-<span class="st"> </span><span class="kw">st_nearest_feature</span>(gps, road)</span>
<span id="cb40-4"><a href="spatial-temporal-mobility-analysis.html#cb40-4" aria-hidden="true"></a></span>
<span id="cb40-5"><a href="spatial-temporal-mobility-analysis.html#cb40-5" aria-hidden="true"></a><span class="co"># for each point: get the distance to the nearest road feature </span></span>
<span id="cb40-6"><a href="spatial-temporal-mobility-analysis.html#cb40-6" aria-hidden="true"></a><span class="co"># // this could take a few minutes</span></span>
<span id="cb40-7"><a href="spatial-temporal-mobility-analysis.html#cb40-7" aria-hidden="true"></a>nearest_road_dst &lt;-<span class="st"> </span><span class="kw">st_distance</span>(gps, road[nearest_road,], <span class="dt">by_element=</span><span class="ot">TRUE</span>, <span class="dt">which=</span><span class="st">&#39;Euclidean&#39;</span>)</span>
<span id="cb40-8"><a href="spatial-temporal-mobility-analysis.html#cb40-8" aria-hidden="true"></a></span>
<span id="cb40-9"><a href="spatial-temporal-mobility-analysis.html#cb40-9" aria-hidden="true"></a><span class="co"># assign values to gps data set</span></span>
<span id="cb40-10"><a href="spatial-temporal-mobility-analysis.html#cb40-10" aria-hidden="true"></a>gps<span class="op">$</span>road_dist &lt;-<span class="st"> </span>nearest_road_dst</span>
<span id="cb40-11"><a href="spatial-temporal-mobility-analysis.html#cb40-11" aria-hidden="true"></a>        </span>
<span id="cb40-12"><a href="spatial-temporal-mobility-analysis.html#cb40-12" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb40-13"><a href="spatial-temporal-mobility-analysis.html#cb40-13" aria-hidden="true"></a>gps </span></code></pre></div>
<pre><code>## Simple feature collection with 27019 features and 17 fields
## Active geometry column: geometry
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 918250.7 ymin: 3775604 xmax: 986130.2 ymax: 3836086
## CRS:            epsg:2053
## # A tibble: 27,019 x 19
##     stop type  duration point_id_n timestamp mode  track_id move  activity
##  * &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   
##  1     1 MEDI…       30          1 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  2     1 MEDI…       30          2 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  3     1 MEDI…       30          5 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  4     1 MEDI…       30          9 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  5     1 MEDI…       30         10 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  6     1 MEDI…       30         12 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  7     1 MEDI…       30         14 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  8     1 MEDI…       30         16 04/02/19… &lt;NA&gt;  001      STAY  STAY    
##  9     1 MEDI…       30         18 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## 10     1 MEDI…       30         22 04/02/19… &lt;NA&gt;  001      STAY  STAY    
## # … with 27,009 more rows, and 10 more variables: geometry &lt;POINT [m]&gt;,
## #   lead_geom &lt;POINT [m]&gt;, dist [m], lead_time &lt;dttm&gt;, diff &lt;drtn&gt;,
## #   speed &lt;dbl&gt;, buf100 &lt;int&gt;, buf250 &lt;int&gt;, buf500 &lt;int&gt;, road_dist [m]</code></pre>
</div>
<div id="gps-data-classification-1" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> GPS data classification</h3>
<p>Now we have added some useful variables to our raw GPS trajectories, we can scale them and move on to our classification algorithms. We will use a <strong>C5.0</strong> boosted decision tree, a <strong>random forest</strong>, and a <strong>support vector machine</strong>. We will use a test/train split of 70/30.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="spatial-temporal-mobility-analysis.html#cb42-1" aria-hidden="true"></a><span class="co"># libraries</span></span>
<span id="cb42-2"><a href="spatial-temporal-mobility-analysis.html#cb42-2" aria-hidden="true"></a><span class="kw">library</span>(e1071)</span>
<span id="cb42-3"><a href="spatial-temporal-mobility-analysis.html#cb42-3" aria-hidden="true"></a><span class="kw">library</span>(randomForest)</span>
<span id="cb42-4"><a href="spatial-temporal-mobility-analysis.html#cb42-4" aria-hidden="true"></a><span class="kw">library</span>(C50)</span>
<span id="cb42-5"><a href="spatial-temporal-mobility-analysis.html#cb42-5" aria-hidden="true"></a><span class="kw">library</span>(caret)</span>
<span id="cb42-6"><a href="spatial-temporal-mobility-analysis.html#cb42-6" aria-hidden="true"></a></span>
<span id="cb42-7"><a href="spatial-temporal-mobility-analysis.html#cb42-7" aria-hidden="true"></a><span class="co"># assign point to train and test</span></span>
<span id="cb42-8"><a href="spatial-temporal-mobility-analysis.html#cb42-8" aria-hidden="true"></a>gps &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">train =</span> <span class="kw">if_else</span>(<span class="kw">runif</span>(<span class="kw">nrow</span>(gps)) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb42-9"><a href="spatial-temporal-mobility-analysis.html#cb42-9" aria-hidden="true"></a></span>
<span id="cb42-10"><a href="spatial-temporal-mobility-analysis.html#cb42-10" aria-hidden="true"></a><span class="co"># create train set, select variables, confirm data types where necessary</span></span>
<span id="cb42-11"><a href="spatial-temporal-mobility-analysis.html#cb42-11" aria-hidden="true"></a>gps_train &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(train<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb42-12"><a href="spatial-temporal-mobility-analysis.html#cb42-12" aria-hidden="true"></a><span class="st">        </span><span class="kw">select</span>(speed,buf100,buf250,buf500,road_dist,move) <span class="op">%&gt;%</span></span>
<span id="cb42-13"><a href="spatial-temporal-mobility-analysis.html#cb42-13" aria-hidden="true"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">road_dist=</span><span class="kw">as.numeric</span>(road_dist))</span>
<span id="cb42-14"><a href="spatial-temporal-mobility-analysis.html#cb42-14" aria-hidden="true"></a></span>
<span id="cb42-15"><a href="spatial-temporal-mobility-analysis.html#cb42-15" aria-hidden="true"></a><span class="co"># drop geometry</span></span>
<span id="cb42-16"><a href="spatial-temporal-mobility-analysis.html#cb42-16" aria-hidden="true"></a>gps_train &lt;-<span class="st"> </span><span class="kw">st_drop_geometry</span>(gps_train)</span>
<span id="cb42-17"><a href="spatial-temporal-mobility-analysis.html#cb42-17" aria-hidden="true"></a></span>
<span id="cb42-18"><a href="spatial-temporal-mobility-analysis.html#cb42-18" aria-hidden="true"></a><span class="co"># scale</span></span>
<span id="cb42-19"><a href="spatial-temporal-mobility-analysis.html#cb42-19" aria-hidden="true"></a>gps_train[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">lapply</span>(gps_train[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="cf">function</span>(x) <span class="kw">scale</span>(x))</span>
<span id="cb42-20"><a href="spatial-temporal-mobility-analysis.html#cb42-20" aria-hidden="true"></a></span>
<span id="cb42-21"><a href="spatial-temporal-mobility-analysis.html#cb42-21" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb42-22"><a href="spatial-temporal-mobility-analysis.html#cb42-22" aria-hidden="true"></a>gps_train</span></code></pre></div>
<pre><code>## # A tibble: 18,943 x 6
##    speed[,1] buf100[,1] buf250[,1] buf500[,1] road_dist[,1] move 
##        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;
##  1    -0.734     -0.474     -0.755     -0.896        -0.742 STAY 
##  2    -0.516     -0.452     -0.755     -0.896        -0.240 STAY 
##  3    -0.594     -0.563     -0.770     -0.896        -0.316 STAY 
##  4    -0.409     -0.519     -0.755     -0.896         0.161 STAY 
##  5    -0.450     -0.541     -0.770     -0.896        -0.658 STAY 
##  6    -0.622     -0.408     -0.755     -0.896        -0.271 STAY 
##  7    -0.560     -0.541     -0.755     -0.896         1.75  STAY 
##  8    -0.571     -0.496     -0.755     -0.896         1.05  STAY 
##  9    -0.740     -0.474     -0.755     -0.896        -0.533 STAY 
## 10     2.49      -0.430     -0.755     -0.896        -0.681 STAY 
## # … with 18,933 more rows</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="spatial-temporal-mobility-analysis.html#cb44-1" aria-hidden="true"></a><span class="co"># create train set, select variables, confirm data types where necessary</span></span>
<span id="cb44-2"><a href="spatial-temporal-mobility-analysis.html#cb44-2" aria-hidden="true"></a>gps_test &lt;-<span class="st"> </span>gps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(train<span class="op">==</span><span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb44-3"><a href="spatial-temporal-mobility-analysis.html#cb44-3" aria-hidden="true"></a><span class="st">        </span><span class="kw">select</span>(speed,buf100,buf250,buf500,road_dist,move) <span class="op">%&gt;%</span></span>
<span id="cb44-4"><a href="spatial-temporal-mobility-analysis.html#cb44-4" aria-hidden="true"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">road_dist=</span><span class="kw">as.numeric</span>(road_dist))</span>
<span id="cb44-5"><a href="spatial-temporal-mobility-analysis.html#cb44-5" aria-hidden="true"></a></span>
<span id="cb44-6"><a href="spatial-temporal-mobility-analysis.html#cb44-6" aria-hidden="true"></a><span class="co"># drop geometry</span></span>
<span id="cb44-7"><a href="spatial-temporal-mobility-analysis.html#cb44-7" aria-hidden="true"></a>gps_test &lt;-<span class="st"> </span><span class="kw">st_drop_geometry</span>(gps_test)</span>
<span id="cb44-8"><a href="spatial-temporal-mobility-analysis.html#cb44-8" aria-hidden="true"></a></span>
<span id="cb44-9"><a href="spatial-temporal-mobility-analysis.html#cb44-9" aria-hidden="true"></a><span class="co"># scale</span></span>
<span id="cb44-10"><a href="spatial-temporal-mobility-analysis.html#cb44-10" aria-hidden="true"></a>gps_test[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">lapply</span>(gps_test[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="cf">function</span>(x) <span class="kw">scale</span>(x))</span>
<span id="cb44-11"><a href="spatial-temporal-mobility-analysis.html#cb44-11" aria-hidden="true"></a></span>
<span id="cb44-12"><a href="spatial-temporal-mobility-analysis.html#cb44-12" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb44-13"><a href="spatial-temporal-mobility-analysis.html#cb44-13" aria-hidden="true"></a>gps_test</span></code></pre></div>
<pre><code>## # A tibble: 8,076 x 6
##    speed[,1] buf100[,1] buf250[,1] buf500[,1] road_dist[,1] move 
##        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;
##  1    -0.682     -0.501     -0.760     -0.902        -0.241 STAY 
##  2    -0.586     -0.567     -0.760     -0.902         1.44  STAY 
##  3    -0.641     -0.478     -0.760     -0.902        -0.209 STAY 
##  4     4.83      -0.612     -0.938     -1.04         -0.547 MOVE 
##  5     5.22      -0.589     -0.923     -1.03         -0.391 MOVE 
##  6     4.83      -0.612     -0.938     -1.04         -0.698 MOVE 
##  7     5.37      -0.612     -0.938     -1.04         -0.408 MOVE 
##  8    -0.714     -0.545     -0.686     -0.772        -0.625 STAY 
##  9    -0.722     -0.434     -0.597     -0.772         0.563 STAY 
## 10    -0.467     -0.301     -0.597     -0.772         0.475 STAY 
## # … with 8,066 more rows</code></pre>
<p>Let’s train our models on our train data and directly predict on our test data.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="spatial-temporal-mobility-analysis.html#cb46-1" aria-hidden="true"></a><span class="co"># boosted decision tree with 5 boosting iterations</span></span>
<span id="cb46-2"><a href="spatial-temporal-mobility-analysis.html#cb46-2" aria-hidden="true"></a>train_boost &lt;-<span class="st"> </span><span class="kw">C5.0</span>(<span class="kw">as.factor</span>(move) <span class="op">~</span>., <span class="dt">data=</span>gps_train, <span class="dt">trials=</span><span class="dv">5</span>)</span>
<span id="cb46-3"><a href="spatial-temporal-mobility-analysis.html#cb46-3" aria-hidden="true"></a></span>
<span id="cb46-4"><a href="spatial-temporal-mobility-analysis.html#cb46-4" aria-hidden="true"></a><span class="co"># support vector machine</span></span>
<span id="cb46-5"><a href="spatial-temporal-mobility-analysis.html#cb46-5" aria-hidden="true"></a>train_svm &lt;-<span class="st"> </span><span class="kw">svm</span>(<span class="kw">as.factor</span>(move) <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>gps_train)</span>
<span id="cb46-6"><a href="spatial-temporal-mobility-analysis.html#cb46-6" aria-hidden="true"></a></span>
<span id="cb46-7"><a href="spatial-temporal-mobility-analysis.html#cb46-7" aria-hidden="true"></a><span class="co"># random forest with 500 trees, 3 variables at each split, sampling with replacement</span></span>
<span id="cb46-8"><a href="spatial-temporal-mobility-analysis.html#cb46-8" aria-hidden="true"></a>train_rf &lt;-<span class="st"> </span><span class="kw">randomForest</span>(<span class="kw">as.factor</span>(move) <span class="op">~</span><span class="st"> </span>., <span class="dt">data=</span>gps_train, <span class="dt">ntree=</span><span class="dv">500</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>, <span class="dt">mtry=</span><span class="dv">3</span>)</span>
<span id="cb46-9"><a href="spatial-temporal-mobility-analysis.html#cb46-9" aria-hidden="true"></a></span>
<span id="cb46-10"><a href="spatial-temporal-mobility-analysis.html#cb46-10" aria-hidden="true"></a><span class="co"># predict boosted decision tree</span></span>
<span id="cb46-11"><a href="spatial-temporal-mobility-analysis.html#cb46-11" aria-hidden="true"></a>test_boost &lt;-<span class="st"> </span><span class="kw">predict</span>(train_boost, gps_test)</span>
<span id="cb46-12"><a href="spatial-temporal-mobility-analysis.html#cb46-12" aria-hidden="true"></a></span>
<span id="cb46-13"><a href="spatial-temporal-mobility-analysis.html#cb46-13" aria-hidden="true"></a><span class="co"># predict support vector machine</span></span>
<span id="cb46-14"><a href="spatial-temporal-mobility-analysis.html#cb46-14" aria-hidden="true"></a>test_svm &lt;-<span class="st"> </span><span class="kw">predict</span>(train_svm, gps_test)</span>
<span id="cb46-15"><a href="spatial-temporal-mobility-analysis.html#cb46-15" aria-hidden="true"></a></span>
<span id="cb46-16"><a href="spatial-temporal-mobility-analysis.html#cb46-16" aria-hidden="true"></a><span class="co"># predict random forest</span></span>
<span id="cb46-17"><a href="spatial-temporal-mobility-analysis.html#cb46-17" aria-hidden="true"></a>test_rf &lt;-<span class="st"> </span><span class="kw">predict</span>(train_rf, gps_test)</span></code></pre></div>
<p>We will use a confusion matrix to inspect our results. A confusion matrix is a table that is often used to describe the performance of a classification model on a set of test data for which the actual values are known. In other words, a confusion matrix can be used to compare the predictions our models make to the ground truth. A confusion matrix basically informs you for all prediction classes how many data points where predicted correctly and how many data points were predicted incorrectly.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="spatial-temporal-mobility-analysis.html#cb47-1" aria-hidden="true"></a><span class="co"># create confusion matrices</span></span>
<span id="cb47-2"><a href="spatial-temporal-mobility-analysis.html#cb47-2" aria-hidden="true"></a>matrix_boost &lt;-<span class="kw">table</span>(test_boost, gps_test<span class="op">$</span>move)</span>
<span id="cb47-3"><a href="spatial-temporal-mobility-analysis.html#cb47-3" aria-hidden="true"></a>matrix_svm &lt;-<span class="st"> </span><span class="kw">table</span>(test_svm, gps_test<span class="op">$</span>move)</span>
<span id="cb47-4"><a href="spatial-temporal-mobility-analysis.html#cb47-4" aria-hidden="true"></a>matrix_rf &lt;-<span class="st"> </span><span class="kw">table</span>(test_rf, gps_test<span class="op">$</span>move)</span>
<span id="cb47-5"><a href="spatial-temporal-mobility-analysis.html#cb47-5" aria-hidden="true"></a></span>
<span id="cb47-6"><a href="spatial-temporal-mobility-analysis.html#cb47-6" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb47-7"><a href="spatial-temporal-mobility-analysis.html#cb47-7" aria-hidden="true"></a>matrix_boost</span></code></pre></div>
<pre><code>##           
## test_boost MOVE STAY
##       MOVE 3175  128
##       STAY  125 4648</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="spatial-temporal-mobility-analysis.html#cb49-1" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb49-2"><a href="spatial-temporal-mobility-analysis.html#cb49-2" aria-hidden="true"></a>matrix_svm</span></code></pre></div>
<pre><code>##         
## test_svm MOVE STAY
##     MOVE 3184  158
##     STAY  116 4618</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="spatial-temporal-mobility-analysis.html#cb51-1" aria-hidden="true"></a><span class="co"># inspect</span></span>
<span id="cb51-2"><a href="spatial-temporal-mobility-analysis.html#cb51-2" aria-hidden="true"></a>matrix_rf</span></code></pre></div>
<pre><code>##        
## test_rf MOVE STAY
##    MOVE 3155   77
##    STAY  145 4699</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="spatial-temporal-mobility-analysis.html#cb53-1" aria-hidden="true"></a><span class="co"># get overall accuracy boosted decision tree</span></span>
<span id="cb53-2"><a href="spatial-temporal-mobility-analysis.html#cb53-2" aria-hidden="true"></a><span class="kw">confusionMatrix</span>(matrix_boost)<span class="op">$</span>overall</span></code></pre></div>
<pre><code>##       Accuracy          Kappa  AccuracyLower  AccuracyUpper   AccuracyNull 
##      0.9686726      0.9351892      0.9646383      0.9723639      0.5913819 
## AccuracyPValue  McnemarPValue 
##      0.0000000      0.8999386</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="spatial-temporal-mobility-analysis.html#cb55-1" aria-hidden="true"></a><span class="co"># get overall accuracy support vector machine</span></span>
<span id="cb55-2"><a href="spatial-temporal-mobility-analysis.html#cb55-2" aria-hidden="true"></a><span class="kw">confusionMatrix</span>(matrix_svm)<span class="op">$</span>overall</span></code></pre></div>
<pre><code>##       Accuracy          Kappa  AccuracyLower  AccuracyUpper   AccuracyNull 
##     0.96607231     0.92993754     0.96188997     0.96991376     0.59138187 
## AccuracyPValue  McnemarPValue 
##     0.00000000     0.01325288</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="spatial-temporal-mobility-analysis.html#cb57-1" aria-hidden="true"></a><span class="co"># get overall accuracy random forest</span></span>
<span id="cb57-2"><a href="spatial-temporal-mobility-analysis.html#cb57-2" aria-hidden="true"></a><span class="kw">confusionMatrix</span>(matrix_rf)<span class="op">$</span>overall</span></code></pre></div>
<pre><code>##       Accuracy          Kappa  AccuracyLower  AccuracyUpper   AccuracyNull 
##   9.725111e-01   9.429407e-01   9.687083e-01   9.759677e-01   5.913819e-01 
## AccuracyPValue  McnemarPValue 
##   0.000000e+00   6.900148e-06</code></pre>
<p>As we can see, all algorithms are highly accurate in classifying our artificial GPS points into <em>moves</em> and <em>stays</em> using the input features that were derived from the raw GPS trajectory data.</p>
</div>
<div id="exercise" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Exercise</h3>
<p>Now we have worked through classifying our points into <em>moves</em> and <em>stays</em> using raw GPS points, there are three further exercises that we want you to do:</p>
<ol style="list-style-type: decimal">
<li>Add a new set of variables that, for every point in the dataset, contains the number of points within a distance of 100m, 250m, and 500m <strong>but for only</strong> those points that are within 5 minutes (both sides) of the point under consideration (i.e. use a moving time window to select the points that qualify). So, for instance, for point <span class="math inline">\(x\)</span> 10 other points are within a distance of 100m but only 5 of these points were recorded within 5 minutes of point <span class="math inline">\(x\)</span>: we now only want those 5 points and not the full 10 points. Please note: this is <strong>not</strong> a trivial task and you will have to considerably change the code that you have used so far. <br/><br/></li>
<li>Instead of using the <em>move</em> column, use the <em>activity</em> column to classify the GPS points into travel modes (i.e. <em>walk</em>, <em>bike</em> , <em>car</em>) and <em>stays</em>. Incorporate all existing variables as well as the three variables you created in Exercise 1. <br/><br/></li>
<li>Assess the <strong>relative</strong> importance of each of the input variables used in Exercise 2 by permutating (that is shuffling) each input variable and re-running the train and test sequence. So, for instance, shuffle the values within the <em>speed</em> column but leaving all the other values untouched, train the three models, and look at the accuracy and Kappa values to see the new results. Repeat this process for all columns in which every time one of the columns gets permutated but all the other values are untouched. With every iteration you save the accuracy and Kappa values so to get an idea about each variable’s relative importance: the variable that causes the largest drop in accuracy and Kappa values is relatively the most important one.
<br/><br/><strong>Tip 1</strong>: You can shuffle your data by sampling without replacement, e.g. <code>gps_test$speed &lt;- sample(gps_test$speed)</code>.
<br/><strong>Tip 2</strong>: Create a function or a loop to conduct this process!</li>
</ol>
</div>
</div>
<div id="take-home-message" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Take home message</h2>
<p>Where GPS technology can precisely register locational information, travel characteristics need to be imputed from the data before it can be used by transport researchers and policy makers. As such, throughout the last decade, various methods have been developed for identifying trips, activities, and travel modes from raw GPS trajectories. In this week’s material, we took a closer look at GPS data. We also introduced you to three different discriminative classifiers to classify GPS points <em>into</em> moves and <em>stays</em>. Be aware that we only given you a brief introduction to these classifiers here and there are in fact many different implementations of <a href="https://towardsdatascience.com/the-complete-guide-to-decision-trees-28a4e3c7be14">decision trees</a> as well many ways of parameterising support vector machines (e.g. choice of kernel). It is also important to keep in mind that because the GPS points used in the tutorial were artificially created, the models results in relatively high prediction rates and will be very difficult to transfer to a different context. While this is obviously an issue, the advantage of using artificial data is that parameters and noise levels can be precisely tuned which allow you to systematically compare, test, and develop different algorithms.</p>
</div>
<div id="attributions_w07" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Attributions</h2>
<p>This week’s content and practical uses content and inspiration from:</p>
<ul>
<li>Van Dijk, J. 2017. Designing Travel Behaviour Change Interventions: a spatiotemporal perspective. <em>Doctoral dissertation</em>. Stellenbosch: Stellenbosch University. <a href="http://hdl%20.handle.net/10019.1/102809">[Link]</a></li>
<li>Van Dijk, J. 2018. Identifying activity-travel points from GPS-data with multiple moving windows. <em>Computers, Environment and Urban Systems</em> 70: 84-101. <a href="https://doi.org/10.1016/j.compenvurbsys.2018.02.004">[Link]</a></li>
</ul>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="spatial-data-science-applications.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="unix-tools.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jtvandijk/GEOG0125/edit/master/07-week07.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/jtvandijk/GEOG0125/raw/master/07-week07.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
